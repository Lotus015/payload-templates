=== Iteration 1 - S1 - 2026-01-19 ===
Status: COMPLETE
Learnings:
- pnpm workspaces work with empty directories (only .gitkeep files)
- pnpm install succeeds even without any packages in workspaces
- Root package.json needs "private": true for monorepo setup
- Used .gitkeep files to preserve empty directories in git
- Test passed: pnpm install completed successfully

=== Iteration 2 - S2 - 2026-01-19 ===
Status: COMPLETE
Learnings:
- ES modules require "type": "module" in package.json
- kleur works well for simple colorized CLI output
- Shebang (#!/usr/bin/env node) required for CLI bin executables
- pnpm automatically picks up new workspace packages on install
- Removed .gitkeep after adding real files to cli/ directory
- Test passed: node cli/bin/index.js displays welcome message

=== Iteration 3 - S3 - 2026-01-19 ===
Status: COMPLETE
Learnings:
- Tailwind CSS v4 requires @tailwindcss/postcss package (not tailwindcss directly as PostCSS plugin)
- Tailwind CSS v4 uses CSS-based config with @import "tailwindcss" instead of tailwind.config.js
- Next.js 16 automatically modifies tsconfig.json (jsx changed to react-jsx, include updated)
- Next.js 16 with Turbopack shows workspace root warning when multiple lockfiles detected
- pnpm workspaces automatically install dependencies from sub-packages
- Test passed: cd templates/premium && pnpm install && pnpm build

=== Iteration 4 - S4 - 2026-01-19 ===
Status: COMPLETE
Learnings:
- Payload CMS 3.x has peer dependency warning with Next.js 16 (expects Next.js 15.x) but builds successfully
- Payload 3.x uses handleServerFunctions from @payloadcms/next/layouts instead of payload.serverFunction()
- Admin routes require (payload) route group with [[...segments]] dynamic catch-all
- API routes need separate handlers for REST (/api/[[...slug]]) and GraphQL (/api/graphql)
- @payload-config TypeScript path alias required in tsconfig.json
- sass package required for Payload admin SCSS styles
- importMap.js exports an empty object by default, populated when custom components are added
- graphql package is a required dependency for Payload 3.x
- Test passed: cd templates/premium && pnpm build

=== Iteration 5 - S5 - 2026-01-19 ===
Status: COMPLETE
Learnings:
- Payload CMS 3.x collections can be defined as separate files with CollectionConfig type
- Collections use export barrel (index.ts) for clean imports in payload.config.ts
- Group field type allows nested field structures (used for hero section in Pages)
- Upload collection with mimeTypes filter restricts allowed file types
- Relationship to media collection uses `type: 'upload'` with `relationTo: 'media'`
- TypeScript types (payload-types.ts) are generated when Payload runs with DB connection, not at build time
- Build compilation validates collection schemas without requiring DB connection
- Test passed: cd templates/premium && pnpm build

=== Iteration 6 - S6 - 2026-01-19 ===
Status: COMPLETE
Learnings:
- Payload 3.x number fields support min/max validation for range constraints (used for rating 1-5)
- Email field type provides built-in email validation
- Checkbox field type with defaultValue: false for boolean flags (read status)
- Date field supports pickerAppearance: 'dayOnly' or 'dayAndTime' for different use cases
- Collections with relationships to Media use `type: 'upload'` with `relationTo: 'media'`
- Pattern from S5 continued: alphabetical ordering in barrel exports and config imports keeps code organized
- Build validates all collection schemas without requiring database connection
- Test passed: cd templates/premium && pnpm build

=== Iteration 7 - S7 - 2026-01-19 ===
Status: COMPLETE
Learnings:
- Payload 3.x globals use GlobalConfig type (different from CollectionConfig)
- Globals are registered via `globals: [...]` array in buildConfig (not within collections)
- Global slugs use kebab-case by convention (e.g., 'site-settings', 'theme-settings')
- Globals support same field types as collections including arrays, uploads, selects
- Default values work well for required fields in globals (ensures valid initial state)
- Array field type perfect for repeatable structures like socialLinks
- Select field type with options array provides dropdown UI in admin
- Pattern continued: barrel export (globals/index.ts) keeps imports clean
- Test passed: cd templates/premium && pnpm build

=== Iteration 8 - S8 - 2026-01-19 ===
Status: COMPLETE
Learnings:
- shadcn/ui with Tailwind v4 requires @theme inline block for color mapping
- Tailwind v4 uses hsl() wrapper for CSS variable colors in @theme inline
- components.json config uses "new-york" style and "rsc": true for React Server Components
- Radix UI primitives work well with React 19 and Next.js 16
- CSS variables for shadcn/ui colors set in @layer base :root and .dark
- Manual component installation preferred over CLI for full control
- Dependencies needed: clsx, tailwind-merge, class-variance-authority, lucide-react
- Radix packages for components: @radix-ui/react-accordion, dialog, label, navigation-menu, separator, slot
- Form component requires react-hook-form, @hookform/resolvers, and zod
- Accordion animations defined via @keyframes in @theme inline block
- lib/utils.ts cn() function combines clsx and tailwind-merge for class merging
- Test passed: cd templates/premium && pnpm build

=== Iteration 9 - S9 - 2026-01-19 ===
Status: COMPLETE
Learnings:
- Hex to HSL conversion: Navy #1a1f36 → HSL 225 37% 16%, Gold #d4af37 → HSL 44 64% 52%
- Tailwind v4 font families defined in @theme inline block as --font-sans, --font-serif, etc.
- next/font/google fonts use `variable` prop to create CSS variables (--font-playfair, --font-inter)
- Font variables must be applied to html element via className for Tailwind to access them
- CSS variables in @layer base :root and .dark enable proper dark/light mode switching
- Premium theme colors extend shadcn/ui's base color system (primary=navy, secondary/accent=gold)
- Extended color palette (--premium-navy, --premium-gold, --premium-cream) mapped in @theme inline for Tailwind utility classes
- antialiased class on body provides smoother font rendering
- Pattern: Keep base shadcn color mappings intact, add theme-specific colors alongside
- Test passed: cd templates/premium && pnpm build

=== Iteration 10 - S10 - 2026-01-19 ===
Status: COMPLETE
Learnings:
- Header component uses 'use client' for Sheet state management (useState for mobile menu)
- Payload getPayload() with config import works for Server Components data fetching
- Navigation items dynamically fetched from Services collection using payload.find()
- Site settings fetched via payload.findGlobal({ slug: 'site-settings' })
- MainLayout is async Server Component that fetches and passes data to client Header/Footer
- Mobile-responsive achieved with lg: breakpoint (hidden lg:flex, lg:hidden patterns)
- Sheet component from shadcn/ui provides mobile menu drawer functionality
- NavigationMenuTrigger + NavigationMenuContent create dropdown menus for services
- Pattern: Use try/catch in getLayoutData() with fallback defaults for build without DB
- Type assertions needed when extracting Payload data (e.g., service.title as string)
- Barrel export (layout/index.ts) maintains clean import pattern from previous stories
- Test passed: cd templates/premium && pnpm build

=== Iteration 11 - S11 - 2026-01-19 ===
Status: COMPLETE
Learnings:
- Homepage sections organized in features/home/components/ directory for feature-based structure
- HeroSection: Uses optional background image with gradient fallback, responsive with min-h-[600px] lg:min-h-[700px]
- ServicesSection: Icon mapping (lucide-react) from string names to components, grid layout with Card components
- AboutSection: Two-column layout with decorative elements, CheckCircle list for features
- TestimonialsSection: Client component ('use client') for carousel state, shows grid for ≤3 items, carousel for >3
- BlogSection: Featured image handling with fallback placeholder, date formatting with toLocaleDateString
- ContactSection: Full form with react-hook-form + zod validation, submits to /api/contact endpoint
- Pattern: All sections accept props with sensible defaults for standalone use or CMS integration
- Premium theme colors (navy, gold, cream) used consistently across all sections via Tailwind classes
- Barrel export (index.ts) alphabetically ordered for consistency with S10 pattern
- Test passed: cd templates/premium && pnpm build

=== Iteration 12 - S12 - 2026-01-19 ===
Status: COMPLETE
Learnings:
- Homepage app/page.tsx composes all sections from features/home/components/ with data fetching
- Dynamic routes in Next.js 16 use `params: Promise<{ slug: string }>` pattern (must await params)
- Service detail pages at app/services/[slug]/page.tsx with sidebar showing other services
- Blog listing at app/blog/page.tsx and detail at app/blog/[slug]/page.tsx with related posts
- Contact page at app/contact/page.tsx reuses ContactSection component with custom props
- generateMetadata async function works with awaited params for dynamic SEO metadata
- JSX.IntrinsicElements namespace not available in modern TypeScript - use explicit conditional rendering instead
- Payload Lexical rich text content has root.children array with type and children properties
- Breadcrumb navigation pattern with ChevronRight icon between links for consistent UX
- notFound() from next/navigation handles 404 cases gracefully
- Promise.all for parallel data fetching (main content + related content) improves performance
- Pattern: try/catch with fallback returns for all Payload queries ensures build without DB works
- Test passed: cd templates/premium && pnpm build

=== Iteration 13 - S13 - 2026-01-19 ===
Status: COMPLETE
Learnings:
- Next.js API routes with Payload Local API use getPayload({ config }) same as Server Components
- API route at app/api/contact/route.ts handles POST requests outside Payload's own API routes
- Zod validation in API route validates: name (2-100 chars), email (valid format), phone (optional), message (10-5000 chars), theme (optional)
- Basic in-memory rate limiting implemented: Map-based tracking with 5 requests per minute per IP
- Rate limiting uses x-forwarded-for or x-real-ip headers for client IP detection
- setInterval cleanup for rate limit map entries older than 2x window prevents memory leaks
- Payload create() method for contact-submissions collection with createdAt timestamp and read: false
- ContactSection form from S11 already submits to /api/contact endpoint - no frontend changes needed
- Pattern: API routes separate from Payload's (payload) route group for custom business logic
- Test passed: cd templates/premium && pnpm build

=== Iteration 14 - S14 - 2026-01-19 ===
Status: COMPLETE
Learnings:
- Seed script uses Payload Local API via getPayload({ config }) same as other server-side code
- updateGlobal() method for seeding globals (site-settings), doesn't require checking for existing
- Idempotency pattern: find() with where clause to check existing, then create() or update() accordingly
- tsx package (^4.7.0) provides simple TypeScript execution for scripts via "pnpm seed"
- Lexical rich text content structure: root.children array with paragraph/heading types, each containing children with text
- Lexical root object needs: type, children, direction, format, indent properties
- Serbian content for Advokat Petrovic law firm includes: 6 services, 3 team members, 3 testimonials, 2 blog posts
- Services use icon names matching lucide-react icons defined in ServicesSection component mapping
- Blog posts use date format 'YYYY-MM-DD' for publishedDate field
- Pattern: Console logging during seed helps track progress and debug issues
- Test passed: cd templates/premium && pnpm build

=== Iteration 15 - S15 - 2026-01-19 ===
Status: COMPLETE
Learnings:
- Template duplication process: copy premium folder, exclude node_modules/.next/tsbuildinfo
- Hex to HSL conversion for Traditional theme: Burgundy #800020 → HSL 345 100% 25%
- Merriweather font requires explicit weight array: ['300', '400', '700', '900']
- Lora font works with default variable weight configuration
- CSS variables renamed from --premium-* to --traditional-* for theme consistency
- Tailwind color utility classes renamed from navy/navy-light/navy-dark to burgundy/burgundy-light/burgundy-dark
- All component files using theme colors (HeroSection, ServicesSection, etc.) need systematic find/replace
- Page files (services/[slug], blog/page, blog/[slug], contact) also reference theme colors
- ContactSection form theme value updated from 'premium' to 'traditional'
- Metadata title/description strings updated from "Premium" to "Traditional" throughout
- CLAUDE.md operating contract updated with Traditional theme specifics
- Peer dependency warning for Next.js 16 with Payload 3.x continues but doesn't affect build
- Test passed: cd templates/traditional && pnpm install && pnpm build

=== Iteration 16 - S16 - 2026-01-19 ===
Status: COMPLETE
Learnings:
- Template duplication process consistent with S15: copy premium folder, exclude node_modules/.next
- Hex to HSL conversion for Modern theme: Light Blue #4a90e2 → HSL 212 72% 59%
- Montserrat and Open Sans fonts work with default subsets configuration
- Modern theme design emphasizes: clean lines, whitespace, lighter visual weight
- CSS variables renamed from --premium-* to --modern-* with blue/slate/white/gray naming
- For Modern theme, accent colors use white on blue backgrounds (contrast with Premium/Traditional gold)
- Tailwind color utility classes renamed: navy→blue, navy-light→blue-light, navy-dark→blue-dark, gold→blue (for accents), cream→white/gray
- All component files systematically updated: HeroSection, ServicesSection, AboutSection, TestimonialsSection, BlogSection, ContactSection
- Page files updated: page.tsx, services/[slug], blog/page, blog/[slug], contact
- ThemeSettings global default values updated for Modern theme fonts and colors
- ContactSection theme value updated from 'premium' to 'modern' in form submission
- Metadata references updated from "Premium" to "Modern" throughout
- CLAUDE.md operating contract updated with Modern theme specifics
- Font variables renamed: --font-playfair→--font-montserrat, --font-inter→--font-opensans
- Test passed: cd templates/modern && pnpm install && pnpm build
